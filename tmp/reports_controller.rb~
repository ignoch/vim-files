-*- encoding: utf-8 -*-
class ReportsController < InheritedResources::Base
  layout "dashboard"
  respond_to :html, :js

  add_breadcrumb 'Reportes', ''

  def details_campaign
    authorize! :roll, :report
    add_breadcrumb 'Detalle de CampaÃ±as', ''
    @campaigns = Campaign.accessible_by(current_ability)
  end

  def details_equip
#    @equips    = Equip.all
#    @campaigns = Campaign.all
    add_breadcrumb 'Detalle de Equipos', ''
    @groups    = Group.all
#    @clients   = Client.all
  end

  def details_client
    add_breadcrumb 'Detalle de Clientes', ''
    @clients = Client.all
  end

  def details_group
    add_breadcrumb 'Detalle de Grupos', ''
    @groups = Group.all
  end

  def equip_monitoring
    add_breadcrumb 'Monitoreo de Equipos', ''
    @campaigns = Campaign.all
  end

  def details_log
    add_breadcrumb 'Reporte logs', ''
  end

  def get_equips
    @equips = Equip.where("campaign_id = ?",params[:campaign_id])
  end

  def get_campaign_detail
    @campaign = Campaign.find(params[:monitor][:campaign])
    @equips   = Equip.in_campaign(@campaign.id)
  end

  def get_equip_detail
    @group = Group.find(params[:monitor][:group])
  end

  def get_group_detail
    @group = Group.find(params[:monitor][:group])
  end

  def get_log_detail
    @report = Report.find_log(params[:log])
  end

  def monitor_results
    @reports = Report.date_range(params[:monitor][:date_start],params[:monitor][:date_end]).where_campaign(params[:monitor][:campaign]).order(:date)
    @equip = Equip.find(params[:monitor][:equips]) unless params[:monitor][:equips].nil?
  end

end
